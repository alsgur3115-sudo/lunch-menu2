<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì ì‹¬ ë­ ë¨¹ì§€? - ë‚ ì”¨ë³„ ë©”ë‰´ ì¶”ì²œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }
            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-orange-400 via-pink-400 to-purple-500 p-4 flex items-center justify-center">
    <div class="max-w-3xl w-full">
        <!-- í—¤ë” -->
        <div class="text-center mb-8">
            <div class="flex items-center justify-center gap-3 mb-4">
                <span class="text-5xl animate-bounce">ğŸ´</span>
                <h1 class="text-5xl font-bold text-white">ì ì‹¬ ë­ ë¨¹ì§€?</h1>
                <span class="text-5xl animate-bounce">â˜•</span>
            </div>
            <p class="text-white text-lg">ì˜¤ëŠ˜ ë‚ ì”¨ì— ë”± ë§ëŠ” ë©”ë‰´ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”</p>
        </div>

        <!-- ì…ë ¥ ì¹´ë“œ -->
        <div class="bg-white rounded-3xl p-8 shadow-2xl mb-6">
            <div class="space-y-6">
                <!-- ë‚ ì”¨ ì„ íƒ -->
                <div>
                    <label class="block text-gray-700 font-semibold mb-3 text-lg">
                        ğŸŒ¤ï¸ ì˜¤ëŠ˜ ë‚ ì”¨ëŠ”?
                    </label>
                    <div class="grid grid-cols-2 sm:grid-cols-5 gap-3">
                        <button onclick="selectWeather('ë§‘ìŒ')" id="btn-ë§‘ìŒ" class="weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium">
                            <div class="text-2xl mb-1">â˜€ï¸</div>
                            <div class="text-sm">ë§‘ìŒ</div>
                        </button>
                        <button onclick="selectWeather('íë¦¼')" id="btn-íë¦¼" class="weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium">
                            <div class="text-2xl mb-1">â˜ï¸</div>
                            <div class="text-sm">íë¦¼</div>
                        </button>
                        <button onclick="selectWeather('ë¹„')" id="btn-ë¹„" class="weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium">
                            <div class="text-2xl mb-1">ğŸŒ§ï¸</div>
                            <div class="text-sm">ë¹„</div>
                        </button>
                        <button onclick="selectWeather('ëˆˆ')" id="btn-ëˆˆ" class="weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium">
                            <div class="text-2xl mb-1">â„ï¸</div>
                            <div class="text-sm">ëˆˆ</div>
                        </button>
                        <button onclick="selectWeather('ë°”ëŒ')" id="btn-ë°”ëŒ" class="weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium">
                            <div class="text-2xl mb-1">ğŸ’¨</div>
                            <div class="text-sm">ë°”ëŒ</div>
                        </button>
                    </div>
                </div>

                <!-- ê¸°ì˜¨ ì…ë ¥ -->
                <div>
                    <label class="block text-gray-700 font-semibold mb-3 text-lg">
                        ğŸŒ¡ï¸ ê¸°ì˜¨ (ì„ íƒì‚¬í•­)
                    </label>
                    <div class="flex items-center gap-3">
                        <input type="number" id="temperature" placeholder="ì˜ˆ: 25" class="flex-1 px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-orange-400 focus:outline-none text-lg">
                        <span class="text-2xl text-gray-600">Â°C</span>
                    </div>
                </div>

                <!-- ì¶”ì²œ ë²„íŠ¼ -->
                <button onclick="getRecommendation()" id="recommendBtn" class="w-full py-4 bg-gradient-to-r from-orange-500 to-pink-500 text-white font-bold text-xl rounded-xl hover:from-orange-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
                    ë©”ë‰´ ì¶”ì²œë°›ê¸° ğŸ½ï¸
                </button>
            </div>
        </div>

        <!-- ì¶”ì²œ ê²°ê³¼ -->
        <div id="resultContainer" class="hidden bg-white rounded-3xl p-8 shadow-2xl animate-fadeIn">
            <div class="space-y-6">
                <!-- ë©”ì¸ ë©”ë‰´ -->
                <div class="text-center pb-6 border-b-2 border-gray-100">
                    <div class="text-6xl mb-4">ğŸ½ï¸</div>
                    <h2 id="mainMenu" class="text-4xl font-bold text-gray-800 mb-4"></h2>
                    <p id="description" class="text-gray-600 text-lg leading-relaxed"></p>
                </div>

                <!-- ëŒ€ì²´ ë©”ë‰´ -->
                <div id="alternativesContainer" class="bg-orange-50 rounded-2xl p-6 hidden">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">ğŸ”„ ë‹¤ë¥¸ ì„ íƒì§€</h3>
                    <div id="alternatives" class="flex flex-wrap gap-2"></div>
                </div>

                <!-- ì‚¬ì´ë“œ & ìŒë£Œ -->
                <div class="grid sm:grid-cols-2 gap-4">
                    <div id="sideDishContainer" class="bg-pink-50 rounded-2xl p-6 hidden">
                        <h3 class="text-lg font-bold text-gray-800 mb-2 flex items-center gap-2">
                            <span>ğŸ¥—</span> ì‚¬ì´ë“œ ë©”ë‰´
                        </h3>
                        <p id="sideDish" class="text-gray-700"></p>
                    </div>
                    
                    <div id="drinkContainer" class="bg-purple-50 rounded-2xl p-6 hidden">
                        <h3 class="text-lg font-bold text-gray-800 mb-2 flex items-center gap-2">
                            <span>ğŸ¥¤</span> ì¶”ì²œ ìŒë£Œ
                        </h3>
                        <p id="drink" class="text-gray-700"></p>
                    </div>
                </div>

                <!-- íŒ -->
                <div id="tipContainer" class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-6 border-2 border-yellow-200 hidden">
                    <h3 class="text-lg font-bold text-gray-800 mb-2 flex items-center gap-2">
                        <span>ğŸ’¡</span> ë§›ìˆê²Œ ë¨¹ëŠ” íŒ
                    </h3>
                    <p id="tip" class="text-gray-700 italic"></p>
                </div>
            </div>
        </div>

        <!-- í‘¸í„° -->
        <div class="text-center mt-8 text-white text-sm">
            <p>ğŸ´ ì˜¤ëŠ˜ë„ ë§›ìˆëŠ” ì ì‹¬ ë˜ì„¸ìš”! ğŸ´</p>
        </div>
    </div>

    <script>
        let selectedWeather = '';

        function selectWeather(weather) {
            selectedWeather = weather;
            
            // ëª¨ë“  ë²„íŠ¼ ì´ˆê¸°í™”
            document.querySelectorAll('.weather-btn').forEach(btn => {
                btn.className = 'weather-btn p-4 rounded-xl border-2 border-gray-200 bg-white hover:border-orange-300 hover:bg-orange-50 transition-all duration-200 font-medium';
            });
            
            // ì„ íƒëœ ë²„íŠ¼ ê°•ì¡°
            const selectedBtn = document.getElementById('btn-' + weather);
            selectedBtn.className = 'weather-btn p-4 rounded-xl border-2 border-orange-500 bg-orange-50 text-orange-700 scale-105 transition-all duration-200 font-medium';
        }

        async function getRecommendation() {
            if (!selectedWeather) {
                alert('ë‚ ì”¨ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }

            const temperature = document.getElementById('temperature').value;
            const btn = document.getElementById('recommendBtn');
            const resultContainer = document.getElementById('resultContainer');

            // ë²„íŠ¼ ë¹„í™œì„±í™”
            btn.disabled = true;
            btn.textContent = 'ë©”ë‰´ ê³ ë¥´ëŠ” ì¤‘... ğŸ³';
            resultContainer.classList.add('hidden');

            try {
                const today = new Date().toLocaleDateString('ko-KR', {
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                });

                const tempInfo = temperature ? `ê¸°ì˜¨ì€ ${temperature}ë„` : 'ê¸°ì˜¨ ì •ë³´ ì—†ìŒ';

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 1000,
                        messages: [{
                            role: 'user',
                            content: `ì˜¤ëŠ˜ì€ ${today}ì´ê³ , ë‚ ì”¨ëŠ” ${selectedWeather}ì…ë‹ˆë‹¤. ${tempInfo}ì…ë‹ˆë‹¤.

ì´ ë‚ ì”¨ì— ë”± ë§ëŠ” ì ì‹¬ ë©”ë‰´ë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€í•˜ê³ , ë‹¤ë¥¸ í…ìŠ¤íŠ¸ëŠ” í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”:

{
  "mainMenu": "ì¶”ì²œ ë©”ì¸ ë©”ë‰´ ì´ë¦„",
  "description": "ì´ ë©”ë‰´ë¥¼ ì¶”ì²œí•˜ëŠ” ì´ìœ  (2-3ë¬¸ì¥, ë‚ ì”¨ì™€ ì—°ê´€ì§€ì–´)",
  "alternatives": ["ëŒ€ì²´ ë©”ë‰´1", "ëŒ€ì²´ ë©”ë‰´2", "ëŒ€ì²´ ë©”ë‰´3"],
  "sideDish": "ì–´ìš¸ë¦¬ëŠ” ì‚¬ì´ë“œ ë©”ë‰´",
  "drink": "ì¶”ì²œ ìŒë£Œ",
  "tip": "ë§›ìˆê²Œ ë¨¹ëŠ” íŒ (1ë¬¸ì¥)"
}

êµ¬ì²´ì ì´ê³  ì‹¤ìš©ì ì¸ í•œì‹, ì¤‘ì‹, ì¼ì‹, ì–‘ì‹ ë“± ë‹¤ì–‘í•œ ë©”ë‰´ë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”.`
                        }]
                    })
                });

                const data = await response.json();
                console.log('API Response:', data);

                if (!data.content || !data.content[0]) {
                    console.error('Invalid response structure:', data);
                    throw new Error('API ì‘ë‹µ êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }

                const content = data.content[0].text;
                console.log('Content:', content);

                // JSON íŒŒì‹±
                let cleanContent = content.replace(/```json\n?|\n?```/g, '').trim();
                cleanContent = cleanContent.replace(/```\n?/g, '').trim();

                const firstBrace = cleanContent.indexOf('{');
                const lastBrace = cleanContent.lastIndexOf('}');
                if (firstBrace !== -1 && lastBrace !== -1) {
                    cleanContent = cleanContent.substring(firstBrace, lastBrace + 1);
                }

                console.log('Clean content:', cleanContent);
                const menuData = JSON.parse(cleanContent);

                if (!menuData.mainMenu || !menuData.description) {
                    throw new Error('Invalid menu data');
                }

                // ê²°ê³¼ í‘œì‹œ
                displayResult(menuData);

            } catch (error) {
                console.error('Error:', error);
                console.error('Error details:', error.message, error.stack);
                alert('ë©”ë‰´ ì¶”ì²œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì˜¤ë¥˜: ' + error.message + '\n\në¸Œë¼ìš°ì € ì½˜ì†”(F12)ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'ë©”ë‰´ ì¶”ì²œë°›ê¸° ğŸ½ï¸';
            }
        }

        function displayResult(data) {
            // ë©”ì¸ ë©”ë‰´
            document.getElementById('mainMenu').textContent = data.mainMenu;
            document.getElementById('description').textContent = data.description;

            // ëŒ€ì²´ ë©”ë‰´
            if (data.alternatives && data.alternatives.length > 0) {
                const alternativesContainer = document.getElementById('alternativesContainer');
                const alternativesDiv = document.getElementById('alternatives');
                alternativesDiv.innerHTML = '';
                data.alternatives.forEach(alt => {
                    const span = document.createElement('span');
                    span.className = 'px-4 py-2 bg-white rounded-full text-gray-700 font-medium shadow-sm';
                    span.textContent = alt;
                    alternativesDiv.appendChild(span);
                });
                alternativesContainer.classList.remove('hidden');
            }

            // ì‚¬ì´ë“œ ë©”ë‰´
            if (data.sideDish) {
                document.getElementById('sideDish').textContent = data.sideDish;
                document.getElementById('sideDishContainer').classList.remove('hidden');
            }

            // ìŒë£Œ
            if (data.drink) {
                document.getElementById('drink').textContent = data.drink;
                document.getElementById('drinkContainer').classList.remove('hidden');
            }

            // íŒ
            if (data.tip) {
                document.getElementById('tip').textContent = `"${data.tip}"`;
                document.getElementById('tipContainer').classList.remove('hidden');
            }

            // ê²°ê³¼ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            document.getElementById('resultContainer').classList.remove('hidden');
            
            // ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
            document.getElementById('resultContainer').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>
</body>
</html>